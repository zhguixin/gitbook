HTTPS工作原理

HTTPS网站，通过openssl命令来产生申请证书的CSR（Certificate Signing Request）。

> oenssl还会产生服务器要用的私钥

通过该CSR去一个CA（Certification Authority 的缩写，它代表世界上那些权威的证书颁发机构）去申请一个证书。

> 申请的证书中，**CA机构会用自己的私钥来加密我们的公钥**。当客户端访问我们的HTTPS网站时，服务器会返回该证书给客户端。客户端要做的是：根据CA机构证书的公钥来解密我们的公钥。
>
> 由于证书是链式结构的，只要根证书已经植入操作系统或浏览器中，那么客户端就可以正常解析出我们的公钥。

CSR文件的组成

包含了证书申请的信息，加密和散列算法，以及公钥

证书申请

可以通过[Let's Encrypt](https://letsencrypt.org/)来申请一个免费证书，提交CSR文件等待审核。

证书内容

审核通过后，会有一下几个文件：

- 域名证书： `cert.pem`（该文件其实是`fullchain.pem`的精简版）
- 证书链：`fullchain.pem`

这些文件可能是 `.pem` 也可能是 `.crt` 后缀，但都是文本文件。证书链文件的内容包括：

- 证书颁发机构：用于寻找链中的下一个验证节点
- 证书的有效期：比如浏览器要根据这个值来判断证书是否已过期
- 证书申请信息：比如浏览器要判断改证书是否可用于当前访问的域名
- 公钥：用于后续和服务端通信的秘钥，这个公钥和当初生成 CSR 时的公钥是一个东西，因为只有它是和服务器的私钥是一对的
- 签名：用于验证证书内容没有被篡改

文章地址：[聊聊 HTTPS 的工作原理](https://www.javadoop.com/post/https)

由于非对称加密复杂耗时，https链接建立后，对传输的数据进行对称加密。对称加密的秘钥则通过客户端拿到的公钥进行加密传输给服务端。

![](.\imgs\https.webp)