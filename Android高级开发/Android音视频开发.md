Android音视频开发

推流

1、音视频采集

推流之前先通过APP上的Camera进行视频采集，通过麦克风进行音频采集。

> 采集之后，编码之前，可以进行美颜滤镜、声音降噪和特效处理

2、音视频编码

视频文件进行H.264进行编码，可以压缩视频文件

音频文件进行AAC编码

> 常说的MP4格式，是编码好后的视频容器，包含了视频、音频、字幕等

3、编码后的二进制文件一起通过RTMP协议，传输到服务端

服务端可以通过Ngnix实现，安装rtmp这个module

> RTMP协议建立在TCP协议之上

4、客户端通过`rtmp://127.0.0.1`获取RTMP协议的流文件，常用播放器有ijkplayer、VLC



H264视频压缩技术

编码器将图片分为三种：I帧、B帧和P帧

- I帧为关键帧，在这个帧中有完整的信息
- B帧为双向内插帧，需要依靠前后两帧得到完整画面，所含信息是最少的
- P帧为前向预测帧，需要依靠前一帧得到完整信息

> 对每一帧进行图片进行宏块划分，取第一帧为I帧，后面的帧满足：**在相邻几幅图像画面中，一般有差别的像素只有10%以内的点,亮度差值变化不超过2%，而色度差值的变化只有1%以内，我们认为这样的图可以分到一组**，一个GOP

两个I帧的距离称为一个GOP（Group Of Pictures），解码端拿到一个关键帧才能解码，因此延时就是一个GOP的长度。