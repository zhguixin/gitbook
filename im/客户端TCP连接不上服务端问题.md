客户端TCP连接不上服务端问题

表现：发送消息太慢，转圈太久的问题

抓包确认TCP的连接过程，发现：TCP SYN请求已经走到了IM服务器上，但没有收到对应的ACK SYN回复。

问题原因：

服务器的tcp_tw_recycle是开启的，开启这个功能，系统就会存下 TCP 连接的时间戳，当同一个 IP 地址过来的包的时间戳小于缓存的时间戳，系统会直接丢包。

开启这个功能是有很大风险的，服务器端会根据同一个 IP 发送过来的包的时间戳来判断是否丢包，而时间戳是根据发包的客户端的系统时间得来的，如果服务端收到的包是同一出口 IP 而系统时间不一样的两个客户端的包，就有可能会丢包，

在服务器上最好打开tcp_tw_reuse，并且关闭tcp_tw_recycle。

参考链接：https://cloud.tencent.com/developer/article/1067489

